<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="controller.Paziente.ModificaPazienteController"
            prefHeight="600.0" prefWidth="700.0" styleClass="root">

    <top>
        <HBox fx:id="navbarContainer" />
    </top>

    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true">
            <StackPane>
                <padding>
                    <Insets top="30" bottom="30" left="30" right="30"/>
                </padding>

                <VBox spacing="25" alignment="CENTER">

                    <!-- Sezione Dati Personali -->
                    <VBox spacing="20" styleClass="box">
                        <Label text="Dati Personali" styleClass="section-title"/>

                        <GridPane alignment="CENTER" hgap="20" vgap="15">
                            <!-- Riga 1: Nome e Cognome -->
                            <Label text="Nome:" GridPane.rowIndex="0" GridPane.columnIndex="0" styleClass="label"/>
                            <TextField fx:id="nome" promptText="Nome" GridPane.rowIndex="0" GridPane.columnIndex="1"
                                       disable="true" prefWidth="150"/>

                            <Label text="Cognome:" GridPane.rowIndex="0" GridPane.columnIndex="2" styleClass="label"/>
                            <TextField fx:id="cognome" promptText="Cognome" GridPane.rowIndex="0" GridPane.columnIndex="3"
                                       disable="true" prefWidth="150"/>

                            <!-- Riga 2: Codice Fiscale e Sesso -->
                            <Label text="Codice Fiscale:" GridPane.rowIndex="1" GridPane.columnIndex="0" styleClass="label"/>
                            <TextField fx:id="taxCode" promptText="Codice Fiscale" GridPane.rowIndex="1" GridPane.columnIndex="1"
                                       disable="true" prefWidth="150"/>

                            <Label text="Sesso:" GridPane.rowIndex="1" GridPane.columnIndex="2" styleClass="label"/>
                            <TextField fx:id="gender" promptText="Sesso" GridPane.rowIndex="1" GridPane.columnIndex="3"
                                       disable="true" prefWidth="150"/>

                            <!-- Riga 3: Data di Nascita -->
                            <Label text="Data di Nascita:" GridPane.rowIndex="2" GridPane.columnIndex="0" styleClass="label"/>
                            <DatePicker fx:id="birthday" prefWidth="150" GridPane.rowIndex="2" GridPane.columnIndex="1"
                                        disable="true"/>
                        </GridPane>
                    </VBox>

                    <!-- Sezione Cambio Password - Collassabile -->
                    <VBox spacing="15" styleClass="box">
                        <HBox spacing="15" alignment="CENTER_LEFT">
                            <Label text="Sicurezza Account" styleClass="section-title"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Button onAction="#onPasswordPressed" text="Cambia Password" styleClass="secondary-button"/>
                        </HBox>

                        <!-- Area espandibile per cambio password -->
                        <VBox fx:id="passwordExpandArea" spacing="15" visible="false" managed="false"
                              style="-fx-background-color: #f8f9fa; -fx-padding: 15; -fx-background-radius: 8; -fx-border-color: #5AC8FA; -fx-border-radius: 8; -fx-border-width: 1;">

                            <Label text="Modifica la tua password" style="-fx-font-size: 14; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>

                            <GridPane hgap="15" vgap="12" alignment="CENTER_LEFT">
                                <Text text="Nuova password" fx:id="nuovaPasswordText" GridPane.rowIndex="0" GridPane.columnIndex="0"
                                      styleClass="label" visible="false"/>
                                <TextField fx:id="nuovaPasswordField" promptText="Inserisci nuova password"
                                           GridPane.rowIndex="0" GridPane.columnIndex="1" prefWidth="250" visible="false"/>

                                <Text text="Conferma password" fx:id="confermaPasswordText" GridPane.rowIndex="1" GridPane.columnIndex="0"
                                      styleClass="label" visible="false"/>
                                <TextField fx:id="confermaPasswordField" promptText="Conferma password"
                                           GridPane.rowIndex="1" GridPane.columnIndex="1" prefWidth="250" visible="false"/>
                            </GridPane>

                            <HBox spacing="12" alignment="CENTER_LEFT">
                                <Button fx:id="confermaPasswordButton" onAction="#onCambiaPasswordPressed"
                                        text="✓ Conferma" style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-weight: bold;"
                                        visible="false"/>
                                <Button text="✕ Chiudi" onAction="#onChiudiPasswordPressed"
                                        style="-fx-background-color: #95a5a6; -fx-text-fill: white;"/>
                            </HBox>

                            <Text fx:id="passwordError" text="Password non valida" styleClass="error" visible="false"/>
                        </VBox>
                    </VBox>

                    <!-- Sezione Dati Sanitari - Nuova per il paziente -->
                    <VBox spacing="20" styleClass="box">
                        <Label text="Dati Sanitari" styleClass="section-title"/>

                        <GridPane alignment="CENTER" hgap="20" vgap="15">
                            <!-- Riga 1: Altezza e Peso -->
                            <Label text="Altezza (m):" GridPane.rowIndex="0" GridPane.columnIndex="0" styleClass="label"/>
                            <TextField fx:id="height" promptText="Altezza in cm" GridPane.rowIndex="0" GridPane.columnIndex="1" prefWidth="120"/>
                            <Text fx:id="heightError" text="Altezza non valida" styleClass="error"
                                  GridPane.rowIndex="1" GridPane.columnIndex="1" visible="false"/>

                            <Label text="Peso (kg):" GridPane.rowIndex="0" GridPane.columnIndex="2" styleClass="label"/>
                            <TextField fx:id="weight" promptText="Peso in kg" GridPane.rowIndex="0" GridPane.columnIndex="3" prefWidth="120"/>
                            <Text fx:id="weightError" text="Peso non valido" styleClass="error"
                                  GridPane.rowIndex="1" GridPane.columnIndex="3" visible="false"/>

                            <!-- Riga 2: Medico Curante -->
                            <Label text="Medico Curante:" GridPane.rowIndex="2" GridPane.columnIndex="0" styleClass="label"/>
                            <TextField fx:id="medicoCurante" promptText="Nome del medico" GridPane.rowIndex="2" GridPane.columnIndex="1"
                                       disable="true" prefWidth="200"/>
                        </GridPane>
                    </VBox>

                    <!-- Sezione Indirizzo -->
                    <VBox spacing="20" styleClass="box">
                        <Label text="Informazioni di Contatto" styleClass="section-title"/>

                        <GridPane alignment="CENTER" hgap="20" vgap="15">
                            <!-- Riga 1: Indirizzo e CAP -->
                            <Label text="Indirizzo:" GridPane.rowIndex="0" GridPane.columnIndex="0" styleClass="label"/>
                            <TextField fx:id="address" promptText="Via/Piazza" GridPane.rowIndex="0" GridPane.columnIndex="1" prefWidth="200"/>
                            <Text fx:id="addressError" text="Indirizzo non valido" styleClass="error"
                                  GridPane.rowIndex="1" GridPane.columnIndex="1" visible="false"/>

                            <Label text="CAP:" GridPane.rowIndex="0" GridPane.columnIndex="2" styleClass="label"/>
                            <TextField fx:id="cap" promptText="CAP" GridPane.rowIndex="0" GridPane.columnIndex="3" prefWidth="100"/>
                            <Text fx:id="capError" text="CAP non valido" styleClass="error"
                                  GridPane.rowIndex="1" GridPane.columnIndex="3" visible="false"/>

                            <!-- Riga 2: Civico e Nazione -->
                            <Label text="Civico:" GridPane.rowIndex="2" GridPane.columnIndex="0" styleClass="label"/>
                            <TextField fx:id="number" promptText="N. civico" GridPane.rowIndex="2" GridPane.columnIndex="1" prefWidth="80"/>
                            <Text fx:id="numberError" text="Numero civico non valido" styleClass="error"
                                  GridPane.rowIndex="3" GridPane.columnIndex="1" visible="false"/>

                            <Label text="Nazione:" GridPane.rowIndex="2" GridPane.columnIndex="2" styleClass="label"/>
                            <TextField fx:id="nation" promptText="Nazione" GridPane.rowIndex="2" GridPane.columnIndex="3" prefWidth="150"/>
                            <Text fx:id="nationError" text="Nazione non valida" styleClass="error"
                                  GridPane.rowIndex="3" GridPane.columnIndex="3" visible="false"/>

                            <!-- Riga 3: Città -->
                            <Label text="Città:" GridPane.rowIndex="4" GridPane.columnIndex="0" styleClass="label"/>
                            <TextField fx:id="citta" promptText="Città" GridPane.rowIndex="4" GridPane.columnIndex="1" prefWidth="150"/>
                            <Text fx:id="cityError" text="Città non valida" styleClass="error"
                                  GridPane.rowIndex="5" GridPane.columnIndex="1" visible="false"/>
                        </GridPane>
                    </VBox>

                    <!-- Sezione Contatti -->
                    <VBox spacing="20" styleClass="box">
                        <Label text="Dati di Contatto" styleClass="section-title"/>

                        <GridPane alignment="CENTER" hgap="20" vgap="15">
                            <Label text="Email:" GridPane.rowIndex="0" GridPane.columnIndex="0" styleClass="label"/>
                            <TextField fx:id="email" promptText="indirizzo@email.com" GridPane.rowIndex="0" GridPane.columnIndex="1"
                                       styleClass="email" prefWidth="250"/>
                            <Text fx:id="emailError" text="Email non valida" styleClass="error"
                                  GridPane.rowIndex="1" GridPane.columnIndex="1" visible="false"/>

                            <Label text="Telefono:" GridPane.rowIndex="2" GridPane.columnIndex="0" styleClass="label"/>
                            <TextField fx:id="telephone" promptText="+39 123 456 7890" GridPane.rowIndex="2" GridPane.columnIndex="1"
                                       prefWidth="200"/>
                            <Text fx:id="telephoneError" text="Numero di telefono non valido" styleClass="error"
                                  GridPane.rowIndex="3" GridPane.columnIndex="1" visible="false"/>
                        </GridPane>
                    </VBox>

                    <!-- Sezione Azioni -->
                    <HBox spacing="20" alignment="CENTER" styleClass="action-section">
                        <Button text="Reset" onAction="#onResetPressed" styleClass="secondary-button" prefWidth="120"/>
                        <Button text="Salva Modifiche" onAction="#onSendButtonPressed" styleClass="primary-button" prefWidth="150"/>
                    </HBox>

                    <Text fx:id="userAddedText" text="Dati aggiornati correttamente!" styleClass="success-message" visible="false"/>

                </VBox>
            </StackPane>
        </ScrollPane>
    </center>

</BorderPane>